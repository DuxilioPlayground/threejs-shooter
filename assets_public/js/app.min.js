!function e(t,n,o){function r(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return r(n?n:e)},l,l.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("../libs/worldHelper"),i=o(r);n["default"]={init:function(e,t){var n=this;this._scene=e,i["default"].generateBoxes(250,"/crate3.jpg",function(e){i["default"].generateBoxes(250,"/crate-tnt-1.jpg",function(o){e=e.concat(o),n._addBoxesToScene(e),t(e)})})},_addBoxesToScene:function(e){var t=this._scene,n=!0,o=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;t.add(s)}}catch(u){o=!0,r=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(o)throw r}}}}},{"../libs/worldHelper":12}],2:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("../libs/Character"),i=o(r);n["default"]={init:function(e){var t=[],n=[{x:20,character:"ogro"},{x:-20}],o=!0,r=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,l=new i["default"](c);e.add(l.getRaw().root),t.push(l)}}catch(d){r=!0,a=d}finally{try{!o&&u["return"]&&u["return"]()}finally{if(r)throw a}}this._characters=t},update:function(){var e=!0,t=!1,n=void 0;try{for(var o,r=this._characters[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var i=o.value;i.update()}}catch(a){t=!0,n=a}finally{try{!e&&r["return"]&&r["return"]()}finally{if(t)throw n}}}}},{"../libs/Character":8}],3:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0}),n.characters=n.boxes=n.playerWeapon=void 0;var r=e("./playerWeapon"),i=o(r),a=e("./boxes"),s=o(a),u=e("./characters"),c=o(u);n.playerWeapon=i["default"],n.boxes=s["default"],n.characters=c["default"]},{"./boxes":1,"./characters":2,"./playerWeapon":4}],4:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("../libs/AnimMD2"),i=o(r),a=e("../libs/movementHelper"),s=o(a);n["default"]={init:function(e){var t=this;this._weapon=new i["default"]({md2:"/shotgun/hud/Dreadus-Shotgun.md2",skin:"/shotgun/hud/Dreadus-Shotgun.jpg",animTimeScale:2,onCreate:function(n){t._mesh=n,n.scale.set(.05,.05,.05),n.rotation.y=Math.PI/2,n.position.x-=1,e.add(n),n.add(t._sounds.shotgunFired)}}),this._positionAnis={breathing:{currOffset:0,currAniDirection:1,aniSpeed:2e-4,maxOffset:.01,updateProp:"rotation",updateAxis:"z"},walking:{currOffset:0,currAniDirection:1,aniSpeed:.009,maxOffset:.1,updateProp:"position",updateAxis:"z"}},this._sounds={},this._initSounds(e),this._bindEvents()},update:function(){var e="walking"===s["default"].getCurrMovement()?"walking":"breathing";this._updatePositionAni(e),this._weapon.update()},_initSounds:function(e){var t=new THREE.AudioListener;e.add(t);var n=new THREE.Audio(t);n.load("assets_public/sounds/shotgunFired.mp3"),this._sounds.shotgunFired=n},_updatePositionAni:function(e){var t=this._mesh,n=this._positionAnis[e],o=n.aniSpeed,r=n.currOffset,i=n.currAniDirection,a=n.maxOffset,s=n.updateProp,u=n.updateAxis;t&&(1===i?(this._positionAnis[e].currOffset-=o,t[s][u]-=o):(this._positionAnis[e].currOffset+=o,t[s][u]+=o),r<=-a?this._positionAnis[e].currAniDirection=2:r>=a&&(this._positionAnis[e].currAniDirection=1))},_bindEvents:function(){var e=this;document.body.addEventListener("click",function(){return e._triggerAction("pow")},!1)},_triggerAction:function(e){var t=this._weapon,n=this._mesh,o=n.children[0];switch(e){case"pow":o.isPlaying||(t.playAnimation("pow",!0),o.play())}}}},{"../libs/AnimMD2":6,"../libs/movementHelper":10}],5:[function(e,t,n){t.exports={movement:{speed:600,jumpHeight:350,enableSuperJump:!1},paths:{img:"assets_public/img",models:"assets_public/models",sounds:"assets_public/sounds"}}},{}],6:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=e("../config"),s=o(a),u=function(){function e(t){var n=this;r(this,e);var o=new THREE.MD2Loader;t.animTimeScale=t.animTimeScale||1,t.md2=s["default"].paths.models+t.md2,t.skin=s["default"].paths.models+t.skin,this._options=t,this._clock=new THREE.Clock,o.load(t.md2,function(e){e.computeBoundingBox();var o=n._mesh=n._createMD2Part(e,THREE.ImageUtils.loadTexture(t.skin));t.onCreate(o)})}return i(e,[{key:"_createMD2Part",value:function(e,t){var n=new THREE.MeshLambertMaterial({color:16755200,wireframe:!0,morphTargets:!0,morphNormals:!0}),o=new THREE.MeshLambertMaterial({color:16777215,wireframe:!1,map:t,morphTargets:!0,morphNormals:!0}),r=new THREE.Mesh(e,o);return r.rotation.y=-Math.PI/2,r.castShadow=!0,r.receiveShadow=!0,r.materialTexture=o,r.materialWireframe=n,this._playingAnimation=!1,this._mixer=new THREE.AnimationMixer(r),this._mesh=r,this._options.animation&&this.playAnimation(this._options.animation),r}},{key:"playAnimation",value:function(e,t){var n=this;if(!this._playingAnimation){var o=this._options,r=this._mixer=new THREE.AnimationMixer(i),i=this._mesh,a=o.animTimeScale;if(r.timeScale=a,i){var s=THREE.AnimationClip.findByName(i.geometry.animations,e);if(s){var u=new THREE.AnimationAction(s,r.time).setLocalRoot(i);r.addAction(u),this._playingAnimation=!0,t&&setTimeout(function(){r.removeAction(u),n._playingAnimation=!1},s.duration/a*1e3)}}}}},{key:"update",value:function(){var e=this._clock.getDelta();this._mixer&&this._mixer.update(e)}}]),e}();n["default"]=u},{"../config":5}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={ratamahatta:{path:"/ratamahatta/",body:"ratamahatta.md2",skins:["ratamahatta.png","ctf_b.png","ctf_r.png","dead.png","gearwhore.png"],weapons:[["weapon.md2","weapon.png"],["w_bfg.md2","w_bfg.png"],["w_blaster.md2","w_blaster.png"],["w_chaingun.md2","w_chaingun.png"],["w_glauncher.md2","w_glauncher.png"],["w_hyperblaster.md2","w_hyperblaster.png"],["w_machinegun.md2","w_machinegun.png"],["w_railgun.md2","w_railgun.png"],["w_rlauncher.md2","w_rlauncher.png"],["w_shotgun.md2","w_shotgun.png"],["w_sshotgun.md2","w_sshotgun.png"]]},ogro:{path:"/ogro/",body:"ogro.md2",skins:["grok.jpg","ogrobase.png","arboshak.png","ctf_r.png","ctf_b.png","darkam.png","freedom.png","gib.png","gordogh.png","igdosh.png","khorne.png","nabogro.png","sharokh.png"],weapons:[["weapon.md2","weapon.jpg"]]}}},{}],8:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=e("../../config"),u=o(s),c=e("./charactersConfig"),l=o(c),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e);var n=this._options=Object.assign({character:"ratamahatta",skin:0,animation:"stand"},t),o=l["default"][n.character],i=this._createCharacter(o);this._eventListeners={},this._clock=new THREE.Clock,this._character=i}return a(e,[{key:"on",value:function(e,t){"array"!=typeof this._eventListeners[e]&&(this._eventListeners[e]=[]),this._eventListeners[e].push(t)}},{key:"_triggerEvent",value:function(e){var t=this,n=this._eventListeners[e];"object"===("undefined"==typeof n?"undefined":i(n))&&n.forEach(function(e){e(t.getRaw())})}},{key:"_createCharacter",value:function(e){var t=this,n=this._options,o=new THREE.MD2Character;return o.scale=.5,o.onLoadComplete=function(){t.setSkin(n.skin),t.setAnimation(n.animation),"number"==typeof n.weapon&&t.setWeapon(n.weapon),"number"==typeof n.x&&(o.root.position.x=n.x),"number"==typeof n.y&&(o.root.position.y=n.y),"number"==typeof n.z&&(o.root.position.z=n.z),t._triggerEvent("create")},e.baseUrl=u["default"].paths.models+e.path,o.loadParts(e),o}},{key:"setSkin",value:function(e){this._character.setSkin(e)}},{key:"setWeapon",value:function(e){this._character.setWeapon(e)}},{key:"setAnimation",value:function(e){this._character.setAnimation(e)}},{key:"getRaw",value:function(){return this._character}},{key:"update",value:function(){var e=this._clock.getDelta();this._character.update(e)}}]),e}();n["default"]=d},{"../../config":5,"./charactersConfig":7}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={init:function(e,t,n){this._controls=new THREE.PointerLockControls(t),this._element=e,this._bindEvents()},getControls:function(){return this._controls},getEnabled:function(){return this._controls.enabled},_bindEvents:function(){document.body.addEventListener("click",this._requestLock.bind(this)),document.addEventListener("pointerlockchange",this._onLockChange.bind(this),!1),document.addEventListener("mozpointerlockchange",this._onLockChange.bind(this),!1),document.addEventListener("webkitpointerlockchange",this._onLockChange.bind(this),!1)},_requestLock:function(){var e=this._element;e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock()},_onLockChange:function(){var e=this._element;document.pointerLockElement===e||document.mozPointerLockElement===e||document.webkitPointerLockElement===e?(console.log("Pointer locked"),this._controls.enabled=!0):(console.log("Pointer lock removed"),this._controls.enabled=!1)}}},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={init:function(e,t,n){this._controls=e,this._options=n,this._collisionObjects=t,this._raycaster=new THREE.Raycaster(new THREE.Vector3,new THREE.Vector3(0,(-1),0),0,10),this._movement={forward:!1,backward:!1,right:!1,left:!1,canJump:!1},this._velocity=new THREE.Vector3,this._prevTime=performance.now(),this._bindKeyEvents()},getCurrMovement:function(){var e=this._movement;for(var t in e)if(e[t])return["forward","backward","right","left"].indexOf(t)!==-1&&e.canJump!==!1?"walking":"canJump"===t?"jumping":"idle"},checkMovement:function(){var e=this._controls,t=this._velocity,n=this._movement,o=this._options,r=performance.now(),i=(r-this._prevTime)/1e3;t.x-=10*t.x*i,t.z-=10*t.z*i,t.y-=9.8*100*i,n.forward&&(t.z-=o.movementSpeed*i),n.backward&&(t.z+=o.movementSpeed*i),n.left&&(t.x-=o.movementSpeed*i),n.right&&(t.x+=o.movementSpeed*i);var a=this._checkObjectsCollision();a&&(t.y=Math.max(0,t.y),n.canJump=!0);var s=e.getObject();s.translateZ(t.z*i),s.translateY(t.y*i),s.translateX(t.x*i),e.getObject().position.y<20&&(t.y=0,s.position.y=20,n.canJump=!0),this._prevTime=r},_checkObjectsCollision:function(){var e=this._raycaster,t=this._collisionObjects,n=this._controls;e.ray.origin.copy(n.getObject().position),e.ray.origin.y-=10;var o=e.intersectObjects(t),r=o.length>0;return r},_bindKeyEvents:function(){var e=this;document.addEventListener("keydown",function(t){var n=t.keyCode;return e._checkKeys(n,!0)},!1),document.addEventListener("keyup",function(t){var n=t.keyCode;return e._checkKeys(n,!1)},!1)},_checkKeys:function(e,t){var n=this._options;switch(e){case 87:this._movement.forward=t;break;case 83:this._movement.backward=t;break;case 68:this._movement.right=t;break;case 65:this._movement.left=t;break;case 32:t===!0&&((this._movement.canJump||n.enableSuperJump)&&(this._velocity.y+=this._options.jumpHeight),this._movement.canJump=!1)}}}},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={rand:function(e,t){return Math.floor(Math.random()*t+e)}}},{}],12:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("../config"),i=o(r),a=e("./utils"),s=o(a);n["default"]={generateRenderer:function(e){var t=new THREE.WebGLRenderer;return t.setClearColor(e),t.setPixelRatio(window.devicePixelRatio||1),t.setSize(window.innerWidth,window.innerHeight),t},generateFloor:function(){var e=new THREE.PlaneGeometry(2e3,2e3,100,100);e.rotateX(-Math.PI/2);for(var t=0,n=e.vertices.length;t<n;t++){var o=e.vertices[t];o.x+=20*Math.random(),o.z+=20*Math.random(),o.y+=Math.random()}for(var r=0,i=e.faces.length;r<i;r++){for(var a=e.faces[r],u=[],c=0;c<3;c++){var l=new THREE.Color("rgb("+s["default"].rand(100,180)+","+s["default"].rand(100,180)+","+s["default"].rand(100,180)+")");u.push(l)}for(var d=0;d<3;d++)a.vertexColors[d]=u[d]}var f=new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors});return new THREE.Mesh(e,f)},generateBoxes:function(e,t,n){var o=this,r=new THREE.TextureLoader,a=function(t){for(var r=void 0,i=[],a=0;a<e;a++)r=o._generateBox({width:20,height:20,depth:20,rgb:[55,81,159],texture:t}),r.position.x=20*Math.floor(20*Math.random()-10),r.position.y=20*Math.floor(20*Math.random())+10,r.position.z=20*Math.floor(20*Math.random()-10),r.rotation.y=-100,i.push(r);n(i)};r.load(i["default"].paths.img+t,function(e){a(e)})},_generateBox:function(e){var t=e.width,n=e.height,o=e.depth,r=e.rgb,i=new THREE.BoxGeometry(t,n,o),a=void 0;if(e.texture)a=new THREE.MeshPhongMaterial({map:e.texture});else{a=new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors});for(var s=void 0,u=void 0,c=0;c<i.faces.length;c++)s=i.faces[c],u=new THREE.Color("rgb("+(r[0]+4*c)+","+(r[1]+4*c)+","+(r[0]+4*c)+")"),s.color=u}return new THREE.Mesh(i,a)}}},{"../config":5,"./utils":11}],13:[function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e){return e&&e.__esModule?e:{"default":e}}function i(){y=new THREE.Scene,b=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e3);var e=new THREE.HemisphereLight(16777215,11184810,.6);y.add(e);var t=f["default"].generateFloor();y.add(t),w=f["default"].generateRenderer(1000540),x.appendChild(w.domElement),p["default"].init(x,b);var n=p["default"].getControls();y.add(n.getObject()),g.boxes.init(y,function(e){_["default"].init(n,e,{movementSpeed:c["default"].movement.speed,jumpHeight:c["default"].movement.jumpHeight,enableSuperJump:c["default"].movement.enableSuperJump}),g.characters.init(y,e),g.playerWeapon.init(b)})}function a(){if(E.begin(),p["default"].getEnabled()){_["default"].checkMovement();var e=!0,t=!1,n=void 0;try{for(var o,r=k[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var i=o.value;i.update()}}catch(s){t=!0,n=s}finally{try{!e&&r["return"]&&r["return"]()}finally{if(t)throw n}}}w.render(y,b),E.end(),requestAnimationFrame(a)}function s(){E=new Stats,E.setMode(0),E.domElement.style.position="absolute",E.domElement.style.left="0px",E.domElement.style.top="0px",x.appendChild(E.domElement)}var u=e("./config"),c=r(u),l=e("./libs/utils"),d=(r(l),e("./libs/worldHelper")),f=r(d),h=e("./libs/lockControlsHelper"),p=r(h),m=e("./libs/movementHelper"),_=r(m),v=e("./components"),g=o(v),y=null,b=null,w=null,E=null,k=Object.values(g).filter(function(e){var t=e.update;return"function"==typeof t}),x=document.body;s(),i(),a()},{"./components":3,"./config":5,"./libs/lockControlsHelper":9,"./libs/movementHelper":10,"./libs/utils":11,"./libs/worldHelper":12}]},{},[13]);
//# sourceMappingURL=app.min.js.map
