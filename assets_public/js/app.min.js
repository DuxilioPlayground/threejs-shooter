!function e(t,n,o){function i(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return i(n?n:e)},l,l.exports,e,t,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("../libs/worldHelper"),r=o(i);n["default"]={init:function(e,t){var n=this;this._scene=e,r["default"].generateBoxes(250,"/crate3.jpg",function(e){r["default"].generateBoxes(250,"/crate-tnt-1.jpg",function(o){e=e.concat(o),n._addBoxesToScene(e),t(e)})})},_addBoxesToScene:function(e){var t=this._scene,n=!0,o=!1,i=void 0;try{for(var r,a=e[Symbol.iterator]();!(n=(r=a.next()).done);n=!0){var s=r.value;t.add(s)}}catch(u){o=!0,i=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(o)throw i}}}}},{"../libs/worldHelper":13}],2:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("../libs/Character"),r=o(i);n["default"]={init:function(e){var t=[],n=[{x:20,character:"ogro"},{x:-20}],o=!0,i=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var c=s.value,l=new r["default"](c);e.add(l.getRaw().root),t.push(l)}}catch(d){i=!0,a=d}finally{try{!o&&u["return"]&&u["return"]()}finally{if(i)throw a}}this._characters=t},getCharacters:function(){return this._characters},update:function(){var e=!0,t=!1,n=void 0;try{for(var o,i=this._characters[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var r=o.value;r.update()}}catch(a){t=!0,n=a}finally{try{!e&&i["return"]&&i["return"]()}finally{if(t)throw n}}}}},{"../libs/Character":8}],3:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0}),n.characters=n.boxes=n.playerWeapon=void 0;var i=e("./playerWeapon"),r=o(i),a=e("./boxes"),s=o(a),u=e("./characters"),c=o(u);n.playerWeapon=r["default"],n.boxes=s["default"],n.characters=c["default"]},{"./boxes":1,"./characters":2,"./playerWeapon":4}],4:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("../libs/AnimMD2"),r=o(i),a=e("../libs/movementHelper"),s=o(a);n["default"]={init:function(e){var t=this;this._weapon=new r["default"]({md2:"/shotgun/hud/Dreadus-Shotgun.md2",skin:"/shotgun/hud/Dreadus-Shotgun.jpg",animTimeScale:2,onCreate:function(n){t._mesh=n,n.scale.set(.05,.05,.05),n.rotation.y=Math.PI/2,n.position.x-=1,e.add(n),n.add(t._sounds.shotgunFired)}}),this._positionAnis={breathing:{currOffset:0,currAniDirection:1,aniSpeed:2e-4,maxOffset:.01,updateProp:"rotation",updateAxis:"z"},walking:{currOffset:0,currAniDirection:1,aniSpeed:.009,maxOffset:.1,updateProp:"position",updateAxis:"z"}},this._sounds={},this._initSounds(e),this._animationCallbacks=[],this._bindEvents()},onAnimation:function(e,t){this._animationCallbacks[e]=t},update:function(){var e="walking"===s["default"].getCurrMovement()?"walking":"breathing";this._updatePositionAni(e),this._weapon.update()},_initSounds:function(e){var t=new THREE.AudioListener;e.add(t);var n=new THREE.Audio(t);n.load("assets_public/sounds/shotgunFired.mp3"),this._sounds.shotgunFired=n},_updatePositionAni:function(e){var t=this._mesh,n=this._positionAnis[e],o=n.aniSpeed,i=n.currOffset,r=n.currAniDirection,a=n.maxOffset,s=n.updateProp,u=n.updateAxis;t&&(1===r?(this._positionAnis[e].currOffset-=o,t[s][u]-=o):(this._positionAnis[e].currOffset+=o,t[s][u]+=o),i<=-a?this._positionAnis[e].currAniDirection=2:i>=a&&(this._positionAnis[e].currAniDirection=1))},_bindEvents:function(){var e=this;document.body.addEventListener("click",function(){return e._triggerAction("pow")},!1)},_triggerAction:function(e){var t=this._weapon,n=this._mesh,o=n.children[0],i=this._animationCallbacks;switch(e){case"pow":o.isPlaying||(t.playAnimation("pow",!0),o.play(),i.pow&&i.pow())}}}},{"../libs/AnimMD2":6,"../libs/movementHelper":11}],5:[function(e,t,n){t.exports={movement:{speed:600,jumpHeight:350,enableSuperJump:!1},paths:{img:"assets_public/img",models:"assets_public/models",sounds:"assets_public/sounds"}}},{}],6:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=e("../config"),s=o(a),u=function(){function e(t){var n=this;i(this,e);var o=new THREE.MD2Loader;t.animTimeScale=t.animTimeScale||1,t.md2=s["default"].paths.models+t.md2,t.skin=s["default"].paths.models+t.skin,this._options=t,this._clock=new THREE.Clock,o.load(t.md2,function(e){e.computeBoundingBox();var o=n._mesh=n._createMD2Part(e,THREE.ImageUtils.loadTexture(t.skin));t.onCreate(o)})}return r(e,[{key:"_createMD2Part",value:function(e,t){var n=new THREE.MeshLambertMaterial({color:16755200,wireframe:!0,morphTargets:!0,morphNormals:!0}),o=new THREE.MeshLambertMaterial({color:16777215,wireframe:!1,map:t,morphTargets:!0,morphNormals:!0}),i=new THREE.Mesh(e,o);return i.rotation.y=-Math.PI/2,i.castShadow=!0,i.receiveShadow=!0,i.materialTexture=o,i.materialWireframe=n,this._playingAnimation=!1,this._mixer=new THREE.AnimationMixer(i),this._mesh=i,this._options.animation&&this.playAnimation(this._options.animation),i}},{key:"playAnimation",value:function(e,t){var n=this;if(!this._playingAnimation){var o=this._options,i=this._mixer=new THREE.AnimationMixer(r),r=this._mesh,a=o.animTimeScale;if(i.timeScale=a,r){var s=THREE.AnimationClip.findByName(r.geometry.animations,e);if(s){var u=new THREE.AnimationAction(s,i.time).setLocalRoot(r);i.addAction(u),this._playingAnimation=!0,t&&setTimeout(function(){i.removeAction(u),n._playingAnimation=!1},s.duration/a*1e3)}}}}},{key:"update",value:function(){var e=this._clock.getDelta();this._mixer&&this._mixer.update(e)}}]),e}();n["default"]=u},{"../config":5}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={ratamahatta:{path:"/ratamahatta/",body:"ratamahatta.md2",skins:["ratamahatta.png","ctf_b.png","ctf_r.png","dead.png","gearwhore.png"],weapons:[["weapon.md2","weapon.png"],["w_bfg.md2","w_bfg.png"],["w_blaster.md2","w_blaster.png"],["w_chaingun.md2","w_chaingun.png"],["w_glauncher.md2","w_glauncher.png"],["w_hyperblaster.md2","w_hyperblaster.png"],["w_machinegun.md2","w_machinegun.png"],["w_railgun.md2","w_railgun.png"],["w_rlauncher.md2","w_rlauncher.png"],["w_shotgun.md2","w_shotgun.png"],["w_sshotgun.md2","w_sshotgun.png"]]},ogro:{path:"/ogro/",body:"ogro.md2",skins:["grok.jpg","ogrobase.png","arboshak.png","ctf_r.png","ctf_b.png","darkam.png","freedom.png","gib.png","gordogh.png","igdosh.png","khorne.png","nabogro.png","sharokh.png"],weapons:[["weapon.md2","weapon.jpg"]]}}},{}],8:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=e("../../config"),u=o(s),c=e("./charactersConfig"),l=o(c),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var n=this._options=Object.assign({character:"ratamahatta",skin:0,animation:"stand"},t),o=l["default"][n.character],r=this._createCharacter(o);this._eventListeners={},this._clock=new THREE.Clock,this._character=r}return a(e,[{key:"on",value:function(e,t){"array"!=typeof this._eventListeners[e]&&(this._eventListeners[e]=[]),this._eventListeners[e].push(t)}},{key:"_triggerEvent",value:function(e){var t=this,n=this._eventListeners[e];"object"===("undefined"==typeof n?"undefined":r(n))&&n.forEach(function(e){e(t.getRaw())})}},{key:"_createCharacter",value:function(e){var t=this,n=this._options,o=new THREE.MD2Character;return o.scale=.5,o.onLoadComplete=function(){t.setSkin(n.skin),t.setAnimation(n.animation),"number"==typeof n.weapon&&t.setWeapon(n.weapon),"number"==typeof n.x&&(o.root.position.x=n.x),"number"==typeof n.y&&(o.root.position.y=n.y),"number"==typeof n.z&&(o.root.position.z=n.z),t._triggerEvent("create")},e.baseUrl=u["default"].paths.models+e.path,o.loadParts(e),o}},{key:"setSkin",value:function(e){this._character.setSkin(e)}},{key:"setWeapon",value:function(e){this._character.setWeapon(e)}},{key:"setAnimation",value:function(e){this._character.setAnimation(e)}},{key:"getRaw",value:function(){return this._character}},{key:"update",value:function(){var e=this._clock.getDelta();this._character.update(e)}}]),e}();n["default"]=d},{"../../config":5,"./charactersConfig":7}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={init:function(e,t,n){this._controls=new THREE.PointerLockControls(t),this._element=e,this._bindEvents()},getControls:function(){return this._controls},getEnabled:function(){return this._controls.enabled},_bindEvents:function(){document.body.addEventListener("click",this._requestLock.bind(this)),document.addEventListener("pointerlockchange",this._onLockChange.bind(this),!1),document.addEventListener("mozpointerlockchange",this._onLockChange.bind(this),!1),document.addEventListener("webkitpointerlockchange",this._onLockChange.bind(this),!1)},_requestLock:function(){var e=this._element;e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock()},_onLockChange:function(){var e=this._element;document.pointerLockElement===e||document.mozPointerLockElement===e||document.webkitPointerLockElement===e?(console.log("Pointer locked"),this._controls.enabled=!0):(console.log("Pointer lock removed"),this._controls.enabled=!1)}}},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={init:function(e){this._raycaster=new THREE.Raycaster,this._mouse=new THREE.Vector2,this._camera=e,this._bindEvents()},_bindEvents:function(){var e=document.querySelector(".cursor");e.setAttribute("style","position: absolute; top: 50%; left: 50%; width: 5px; height: 5px; border: solid 1px red; border-radius: 100%; margin: -10px 0 0 -10px; z-index 99;"),window.addEventListener("mousemove",this._onMouseMove.bind(this))},_onMouseMove:function(e){var t=e.clientX/window.innerWidth*2-1,n=2*-(e.clientY/window.innerHeight)+1;this._mouse.x=t,this._mouse.y=n},checkCollidingWithObjects:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this._raycaster;t&&(n.far=t),n.setFromCamera(this._mouse,this._camera);var o=n.intersectObjects(e),i=!0,r=!1,a=void 0;try{for(var s,u=o[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value.object;c.material.color.set(16711680)}}catch(l){r=!0,a=l}finally{try{!i&&u["return"]&&u["return"]()}finally{if(r)throw a}}return o}}},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={init:function(e,t,n){this._controls=e,this._options=n,this._collisionObjects=t,this._raycaster=new THREE.Raycaster(new THREE.Vector3,new THREE.Vector3(0,(-1),0),0,10),this._movement={forward:!1,backward:!1,right:!1,left:!1,canJump:!1},this._velocity=new THREE.Vector3,this._prevTime=performance.now(),this._bindKeyEvents()},getCurrMovement:function(){var e=this._movement;for(var t in e)if(e[t])return["forward","backward","right","left"].indexOf(t)!==-1&&e.canJump!==!1?"walking":"canJump"===t?"jumping":"idle"},checkMovement:function(){var e=this._controls,t=this._velocity,n=this._movement,o=this._options,i=performance.now(),r=(i-this._prevTime)/1e3;t.x-=10*t.x*r,t.z-=10*t.z*r,t.y-=9.8*100*r,n.forward&&(t.z-=o.movementSpeed*r),n.backward&&(t.z+=o.movementSpeed*r),n.left&&(t.x-=o.movementSpeed*r),n.right&&(t.x+=o.movementSpeed*r);var a=this._checkObjectsCollision();a&&(t.y=Math.max(0,t.y),n.canJump=!0);var s=e.getObject();s.translateZ(t.z*r),s.translateY(t.y*r),s.translateX(t.x*r),e.getObject().position.y<20&&(t.y=0,s.position.y=20,n.canJump=!0),this._prevTime=i},_checkObjectsCollision:function(){var e=this._raycaster,t=this._collisionObjects,n=this._controls;e.ray.origin.copy(n.getObject().position),e.ray.origin.y-=10;var o=e.intersectObjects(t),i=o.length>0;return i},_bindKeyEvents:function(){var e=this;document.addEventListener("keydown",function(t){var n=t.keyCode;return e._checkKeys(n,!0)},!1),document.addEventListener("keyup",function(t){var n=t.keyCode;return e._checkKeys(n,!1)},!1)},_checkKeys:function(e,t){var n=this._options;switch(e){case 87:this._movement.forward=t;break;case 83:this._movement.backward=t;break;case 68:this._movement.right=t;break;case 65:this._movement.left=t;break;case 32:t===!0&&((this._movement.canJump||n.enableSuperJump)&&(this._velocity.y+=this._options.jumpHeight),this._movement.canJump=!1)}}}},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={rand:function(e,t){return Math.floor(Math.random()*t+e)}}},{}],13:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var i=e("../config"),r=o(i),a=e("./utils"),s=o(a);n["default"]={generateRenderer:function(e){var t=new THREE.WebGLRenderer;return t.setClearColor(e),t.setPixelRatio(window.devicePixelRatio||1),t.setSize(window.innerWidth,window.innerHeight),t},generateFloor:function(){var e=new THREE.PlaneGeometry(2e3,2e3,100,100);e.rotateX(-Math.PI/2);for(var t=0,n=e.vertices.length;t<n;t++){var o=e.vertices[t];o.x+=20*Math.random(),o.z+=20*Math.random(),o.y+=Math.random()}for(var i=0,r=e.faces.length;i<r;i++){for(var a=e.faces[i],u=[],c=0;c<3;c++){var l=new THREE.Color("rgb("+s["default"].rand(100,180)+","+s["default"].rand(100,180)+","+s["default"].rand(100,180)+")");u.push(l)}for(var d=0;d<3;d++)a.vertexColors[d]=u[d]}var h=new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors});return new THREE.Mesh(e,h)},generateBoxes:function(e,t,n){var o=this,i=new THREE.TextureLoader,a=function(t){for(var i=void 0,r=[],a=0;a<e;a++)i=o._generateBox({width:20,height:20,depth:20,rgb:[55,81,159],texture:t}),i.position.x=20*Math.floor(20*Math.random()-10),i.position.y=20*Math.floor(20*Math.random())+10,i.position.z=20*Math.floor(20*Math.random()-10),i.rotation.y=-100,r.push(i);n(r)};i.load(r["default"].paths.img+t,function(e){a(e)})},_generateBox:function(e){var t=e.width,n=e.height,o=e.depth,i=e.rgb,r=new THREE.BoxGeometry(t,n,o),a=void 0;if(e.texture)a=new THREE.MeshPhongMaterial({map:e.texture});else{a=new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors});for(var s=void 0,u=void 0,c=0;c<r.faces.length;c++)s=r.faces[c],u=new THREE.Color("rgb("+(i[0]+4*c)+","+(i[1]+4*c)+","+(i[0]+4*c)+")"),s.color=u}return new THREE.Mesh(r,a)}}},{"../config":5,"./utils":12}],14:[function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e&&e.__esModule?e:{"default":e}}function r(){w=new THREE.Scene,E=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e3);var e=new THREE.HemisphereLight(16777215,11184810,.6);w.add(e);var t=h["default"].generateFloor();w.add(t),k=h["default"].generateRenderer(1000540),H.appendChild(k.domElement),p["default"].init(H,E);var n=p["default"].getControls();w.add(n.getObject()),b.boxes.init(w,function(e){v["default"].init(n,e,{movementSpeed:c["default"].movement.speed,jumpHeight:c["default"].movement.jumpHeight,enableSuperJump:c["default"].movement.enableSuperJump}),b.characters.init(w,e),g["default"].init(E),b.playerWeapon.init(E),b.playerWeapon.onAnimation("pow",function(){var e=g["default"].checkCollidingWithObjects(window.boxes),t=!0,n=!1,o=void 0;try{for(var i,r=e[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var a=i.value.object;w.remove(a)}}catch(s){n=!0,o=s}finally{try{!t&&r["return"]&&r["return"]()}finally{if(n)throw o}}}),window.boxes=e})}function a(){if(x.begin(),p["default"].getEnabled()){v["default"].checkMovement();var e=!0,t=!1,n=void 0;try{for(var o,i=M[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var r=o.value;r.update()}}catch(s){t=!0,n=s}finally{try{!e&&i["return"]&&i["return"]()}finally{if(t)throw n}}}k.render(w,E),x.end(),requestAnimationFrame(a)}function s(){x=new Stats,x.setMode(0),x.domElement.style.position="absolute",x.domElement.style.left="0px",x.domElement.style.top="0px",H.appendChild(x.domElement)}var u=e("./config"),c=i(u),l=e("./libs/utils"),d=(i(l),e("./libs/worldHelper")),h=i(d),f=e("./libs/lockControlsHelper"),p=i(f),m=e("./libs/movementHelper"),v=i(m),_=e("./libs/mouseHelper"),g=i(_),y=e("./components"),b=o(y),w=null,E=null,k=null,x=null,M=Object.values(b).filter(function(e){var t=e.update;return"function"==typeof t}),H=document.body;s(),r(),a()},{"./components":3,"./config":5,"./libs/lockControlsHelper":9,"./libs/mouseHelper":10,"./libs/movementHelper":11,"./libs/utils":12,"./libs/worldHelper":13}]},{},[14]);
//# sourceMappingURL=app.min.js.map
